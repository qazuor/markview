/* Preview themes - must be before @tailwind */
@import "./preview-themes/index.css";

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        /* Light theme colors */
        --color-bg-primary: 255 255 255;
        --color-bg-secondary: 248 250 252;
        --color-bg-tertiary: 241 245 249;
        --color-text-primary: 15 23 42;
        --color-text-secondary: 71 85 105;
        --color-text-muted: 148 163 184;
        --color-border: 226 232 240;
        --color-accent: 14 165 233;
    }

    .dark {
        /* Dark theme colors */
        --color-bg-primary: 15 23 42;
        --color-bg-secondary: 30 41 59;
        --color-bg-tertiary: 51 65 85;
        --color-text-primary: 248 250 252;
        --color-text-secondary: 203 213 225;
        --color-text-muted: 100 116 139;
        --color-border: 51 65 85;
        --color-accent: 56 189 248;
    }

    * {
        @apply border-border;
    }

    html {
        @apply antialiased;
    }

    body {
        @apply bg-bg-primary text-text-primary;
        font-feature-settings: "rlig" 1, "calt" 1;
    }
}

@layer components {
    .bg-bg-primary {
        background-color: rgb(var(--color-bg-primary));
    }

    .bg-bg-secondary {
        background-color: rgb(var(--color-bg-secondary));
    }

    .bg-bg-tertiary {
        background-color: rgb(var(--color-bg-tertiary));
    }

    .text-text-primary {
        color: rgb(var(--color-text-primary));
    }

    .text-text-secondary {
        color: rgb(var(--color-text-secondary));
    }

    .text-text-muted {
        color: rgb(var(--color-text-muted));
    }

    .border-border {
        border-color: rgb(var(--color-border));
    }
}

@layer utilities {
    .scrollbar-thin {
        scrollbar-width: thin;
    }

    .scrollbar-hide {
        scrollbar-width: none;
        -ms-overflow-style: none;
    }

    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
}

/* Custom scrollbar styles for editor and preview panels */
.cm-scroller,
[class*="preview-"][class*="overflow-auto"] {
    scrollbar-width: thin;
    scrollbar-color: rgb(203 213 225) transparent;
}

.cm-scroller::-webkit-scrollbar,
[class*="preview-"][class*="overflow-auto"]::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

.cm-scroller::-webkit-scrollbar-track,
[class*="preview-"][class*="overflow-auto"]::-webkit-scrollbar-track {
    background: transparent;
}

.cm-scroller::-webkit-scrollbar-thumb,
[class*="preview-"][class*="overflow-auto"]::-webkit-scrollbar-thumb {
    background-color: rgb(203 213 225);
    border-radius: 4px;
    border: 2px solid transparent;
    background-clip: content-box;
}

.cm-scroller::-webkit-scrollbar-thumb:hover,
[class*="preview-"][class*="overflow-auto"]::-webkit-scrollbar-thumb:hover {
    background-color: rgb(148 163 184);
}

.cm-scroller::-webkit-scrollbar-corner,
[class*="preview-"][class*="overflow-auto"]::-webkit-scrollbar-corner {
    background: transparent;
}

/* Dark theme scrollbar */
.dark .cm-scroller,
.dark [class*="preview-"][class*="overflow-auto"] {
    scrollbar-color: rgb(71 85 105) transparent;
}

.dark .cm-scroller::-webkit-scrollbar-thumb,
.dark [class*="preview-"][class*="overflow-auto"]::-webkit-scrollbar-thumb {
    background-color: rgb(71 85 105);
}

.dark .cm-scroller::-webkit-scrollbar-thumb:hover,
.dark [class*="preview-"][class*="overflow-auto"]::-webkit-scrollbar-thumb:hover {
    background-color: rgb(100 116 139);
}

/* CodeMirror container constraints */
.cm-editor {
    height: 100%;
    max-width: 100%;
    overflow: hidden;
}

.cm-scroller {
    overflow: auto !important;
}

.cm-content {
    min-width: 0;
}

/* Minimap styles */
.cm-editor .cm-gutters.cm-minimap-gutter {
    padding-left: 10px;
}

.cm-editor .cm-minimap-inner {
    border-left: 1px solid rgb(203 213 225); /* slate-300 for light theme */
    padding-left: 5px;
    left: 5px;
}

.dark .cm-editor .cm-minimap-inner {
    border-left: 1px solid rgb(71 85 105); /* slate-600 for dark theme */
}

/* Minimap overlay (visible block indicator) */
.cm-minimap-overlay {
    background: rgb(14 165 233) !important; /* sky-500 */
    opacity: 0.25 !important;
}

.cm-minimap-overlay:hover {
    opacity: 0.35 !important;
}

.cm-minimap-overlay-active .cm-minimap-overlay {
    opacity: 0.45 !important;
}

.dark .cm-minimap-overlay {
    background: rgb(56 189 248) !important; /* sky-400 */
    opacity: 0.3 !important;
}

.dark .cm-minimap-overlay:hover {
    opacity: 0.4 !important;
}

.dark .cm-minimap-overlay-active .cm-minimap-overlay {
    opacity: 0.5 !important;
}

/* Prevent text selection while dragging minimap overlay */
body:has(.cm-minimap-overlay-active) {
    user-select: none;
    -webkit-user-select: none;
    cursor: grabbing !important;
}

body:has(.cm-minimap-overlay-active) * {
    cursor: grabbing !important;
}
